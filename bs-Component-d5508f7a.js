define("@widget/PDF/bs-Component-d5508f7a.js",["exports"],(function(e){"use strict";function t(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var a=(global.keyMirror||guac.keymirror)({PDF_SECTION_TITLE_RENDERED:null,PDF_HEADING_RENDERED:null,PDF_DESCRIPTION_RENDERED:null,PDF_DOWNLOAD_LINK_RENDERED:null,PDF_PREVIEW_RENDERED:null,PDF_PREV_BTN_RENDERED:null,PDF_NEXT_BTN_RENDERED:null,PDF_PAGE_NOTATION_RENDERED:null,PDF_NONDISPLAY_PLACEHOLDER_RENDERED:null,PDF_DISPLAY_PLACEHOLDER_RENDERED:null,PDF_LINK_OVERLAY:null,PDF_LOADING_ANIMATION:null});const{PUBLISH:r}=(global.Core||guac["@wsb/guac-widget-core"]).constants.renderModes;class n extends(global.React||guac.react).Component{constructor(){super(...arguments),t(this,"loadPDFJS",(()=>{"undefined"!=typeof window&&window.pdfjsLib?this.renderPage(this.state.pageNum):(this.scriptEl=document.createElement("script"),this.scriptEl.src="https://img1.wsimg.com/blobby/go/static/pdf.js/2.6.347/pdf.min.js",this.scriptEl.onload=this.pdfjsLoaded,document.head.appendChild(this.scriptEl))})),t(this,"pdfjsLoaded",(()=>{pdfjsLib.GlobalWorkerOptions.workerSrc="https://img1.wsimg.com/blobby/go/static/pdf.js/2.6.347/pdf.worker.min.js",this.renderPage(this.state.pageNum)})),t(this,"renderPage",(e=>{const{renderMode:t,pdfUrl:a}=this.props,{pageNumPending:n}=this.state;this.setState({pageRendering:!0}),this.getArrayBuffer(a,(a=>{pdfjsLib.getDocument({data:a}).promise.then((a=>{a.getPage(e).then((o=>{const{isHorizontal:i,renderContext:l}=this.getCanvasProperties(o,e);this.setState({isHorizontal:i,numPages:a.numPages},(()=>{o.render(l).promise.then((()=>{if(null!==n){const e=n;this.setState({pageNumPending:null},(()=>{this.renderPage(e)}))}else if(this.setState({pageRendering:!1}),t===r&&"undefined"!=typeof window){var o,l;const t=(global.Core||guac["@wsb/guac-widget-core"]).UX2.utils.TCCLUtils.getTCCLString({eid:"ux2.pdf.preview.impression",type:"impression",data:{pageNum:`${e}`,numPages:`${a.numPages}`,layout:i?"horizontal":"vertical"}});null===(o=(l=window).logTcclEvent)||void 0===o||o.call(l,null,t)}})).catch((e=>{console.error(e),o&&this.setState({pageRendering:!1})}))}))}))}),(e=>{console.error(e)}))}))})),t(this,"handleKeyDown",(e=>{const{pageNum:t,numPages:a}=this.state,r=e&&(e.keyCode||e.code),n=39===r&&t<a;37===r&&t>1&&this.queueRenderPage(t-1),n&&this.queueRenderPage(t+1)})),this.state={pageNum:1,pageRendering:!1,pageNumPending:null,numPages:0,isHorizontal:!1},this.canvas=(global.React||guac.react).createRef(),this.canvasWrapper=(global.React||guac.react).createRef()}componentDidMount(){this.loadPDFJS();const{isMobile:e}=this.props;void 0!==typeof window&&!e&&window.innerWidth>767&&window.IntersectionObserver&&(this.focusObserver=new window.IntersectionObserver((e=>{e&&e[0]&&e[0].isIntersecting&&e[0].target.focus({preventScroll:!0})})),this.focusObserver.observe(this.canvasWrapper.current))}componentWillUnmount(){this.focusObserver&&this.focusObserver.unobserve(this.canvasWrapper.current)}componentDidUpdate(e){e.pdfUrl!==this.props.pdfUrl&&this.setState({pageNum:1,pageRendering:!1,pageNumPending:null,numPages:0,isHorizontal:!1},(()=>{this.renderPage(1)}))}getArrayBuffer(e,t){const a=new XMLHttpRequest;a.open("GET",e,!0),a.responseType="arraybuffer",a.onload=()=>{const e=a.response;if(e)return t(new Uint8Array(e))},a.send(null)}getCanvasProperties(e,t){const a=this.canvas.current,r=e.getViewport({scale:2.5}),n=a.getContext("2d");a.width=r.width,a.height=r.height;return{isHorizontal:1===t?a.width>a.height:this.state.isHorizontal,renderContext:{canvasContext:n,viewport:r}}}renderLoadingState(){const{staticContent:e}=this.props;return(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Block,{category:"primary",style:{height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",backgroundColor:"neutralOverlay",position:"absolute",top:"0",width:"100%",color:"accent","> p":{color:"accent"}}},(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Loader,{"data-aid":a.PDF_LOADING_ANIMATION}),(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Text,{children:e.loadingStateMessage}))}renderLinkOverlay(){const{pdfUrl:e}=this.props;return(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Link,{"data-aid":a.PDF_LINK_OVERLAY,target:"_blank",href:e,style:{display:"block",height:"100%",position:"absolute",top:"0",width:"100%","@sm":{display:"none"}}})}renderPageNavigation(){const{pageNum:e,numPages:t,isHorizontal:r}=this.state,{staticContent:n}=this.props,o=e>1,i=e<t,l={block:{marginTop:"large",textAlign:"center",display:"flex",alignItems:"center",justifyContent:"center",color:"primary"},button:{display:"inline-flex",outline:"none",alignItems:"center","> *":{color:"primary"}},buttonWrapper:{display:"inline-flex",alignItems:"center"},pipe:{marginHorizontal:"small",backgroundColor:"section"},pageNotation:{color:"primary",lineHeight:"inherit"}},s=(global.Core||guac["@wsb/guac-widget-core"]).UX2.utils.TCCLUtils.getTCCLString({eid:"ux2.pdf.prev_button.click",type:"click",data:{pageNum:""+(e-1),numPages:`${t}`,layout:r?"horizontal":"vertical"}}),c=(global.Core||guac["@wsb/guac-widget-core"]).UX2.utils.TCCLUtils.getTCCLString({eid:"ux2.pdf.next_button.click",type:"click",data:{pageNum:`${e+1}`,numPages:`${t}`,layout:r?"horizontal":"vertical"}});return(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Block,{style:l.block},o&&(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Block,{style:l.buttonWrapper},(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.MoreLink.Backward,{"data-tccl":s,onClick:this.queueRenderPage.bind(this,e-1),"data-aid":a.PDF_PREV_BTN_RENDERED,children:n.previous,style:l.button,"data-edit-interactive":!0,tabIndex:0,onKeyDown:this.handleKeyDown}),(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Pipe,{category:"primary",style:l.pipe})),(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Text,{style:l.pageNotation,"data-aid":a.PDF_PAGE_NOTATION_RENDERED},`${e}/${t}`),i&&(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Block,{style:l.buttonWrapper},(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Pipe,{category:"primary",style:l.pipe}),(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.MoreLink.Forward,{"data-tccl":c,onClick:this.queueRenderPage.bind(this,e+1),"data-aid":a.PDF_NEXT_BTN_RENDERED,children:n.next,style:l.button,"data-edit-interactive":!0,tabIndex:0,onKeyDown:this.handleKeyDown})))}queueRenderPage(e){const{pageRendering:t}=this.state;this.setState({pageNum:e},(()=>{t?this.setState({pageNumPending:e}):this.renderPage(e)}))}generateStyles(){return{block:{display:"flex",backgroundColor:"section",padding:"xxsmall","> div > canvas":{width:"100%",height:"100%"}},canvasWrapper:{width:"100%",position:"relative",outline:"none"}}}render(){const{section:e}=this.props,{pageNum:t,numPages:r,isHorizontal:n,pageRendering:o}=this.state,i=t>1,l=t<r,s=this.generateStyles(i,l);return(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Component.Grid.Cell,{inset:!n},(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Block,{section:"default"===e?"alt":"default",style:s.block},(global.React||guac.react).createElement("div",{style:s.canvasWrapper,ref:this.canvasWrapper,tabIndex:0,onKeyDown:this.handleKeyDown},(global.React||guac.react).createElement("canvas",{"data-aid":a.PDF_PREVIEW_RENDERED,ref:this.canvas}),o&&this.renderLoadingState(),this.renderLinkOverlay())),r>1&&this.renderPageNavigation())}}n.propTypes={pdfUrl:(global.PropTypes||guac["prop-types"]).string.isRequired,staticContent:(global.PropTypes||guac["prop-types"]).object,category:(global.PropTypes||guac["prop-types"]).string,section:(global.PropTypes||guac["prop-types"]).string,renderMode:(global.PropTypes||guac["prop-types"]).string,isMobile:(global.PropTypes||guac["prop-types"]).bool},e.default=n,Object.defineProperty(e,"__esModule",{value:!0})})),"undefined"!=typeof window&&(window.global=window);
//# sourceMappingURL=bs-Component-d5508f7a.js.map
